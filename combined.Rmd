---
title: "2015 NFL Season Stats"
output: html_document

---

```{r setup, include=FALSE}
# packages
library(dplyr)
library(ggplot2)
library(nflscrapR)
library(highcharter)
library(rvest)
library(RCurl)
library(stringr)
library(reshape2)
library(purrr)
library(lubridate)
library(xts)
library(knitr)

# load data
season.2015.x <- getURL("https://raw.githubusercontent.com/brndngrhm/eagles/master/season.2015.csv")
season.2015 <- as.data.frame(read.csv(text = season.2015.x, strip.white = T))
phl.x <- getURL("https://raw.githubusercontent.com/brndngrhm/eagles/master/phl.csv")
phl <- as.data.frame(read.csv(text = phl.x, strip.white = T))
eagles.hist.x <- getURL("https://raw.githubusercontent.com/brndngrhm/eagles/master/eagles.hist.csv")
eagles.hist <- as.data.frame(read.csv(text = eagles.hist.x, strip.white = T))
rm(season.2015.x, eagles.hist.x, phl.x)

# global plotting parameters 
hc_params <- highchart() %>%
  hc_chart(zoomType = "x") %>%
  hc_tooltip(crosshairs = TRUE, shared = TRUE, borderWidth = 1, shared=T) %>%
  hc_yAxis(title=" ") %>%
  hc_exporting(enabled = TRUE) %>%
  hc_credits(enabled = TRUE,
             text = "NFL Data from nflscrapR",
             href = "https://github.com/maksimhorowitz/nflscrapR") %>% 
  hc_add_theme(hc_theme_gridlight()) %>%
  hc_legend(enabled = FALSE) %>%
  hc_subtitle(text="2015 Season (Click & Drag to Zoom)", align="left") %>%
  hc_yAxis(title=" ") %>%
  hc_exporting(enabled = TRUE,
               filename = "plot_data")

top.n <- 40          #how many names to show on axis
plot.type <- "bar"   #type of plot
alignment <- "left"  #subtitle alignment

```

Quick and easy viewing of basic NFL Stats.
Code available for every plot on github [here.](https://github.com/brndngrhm/eagles/blob/master/combined.Rmd)  
Data obtained using the *nflscrapR* package. More details on that [here.](https://github.com/maksimhorowitz/nflscrapR)  
Plots done in R using the *Highcharter* package.  More details on that [here.](http://jkunst.com/highcharter/)

# NFL {.tabset}
## Player Stats {.tabset}
### Offense {.tabset}
#### Passing Attempts
```{r, echo = F, fig.height = 20, fig.width = 10}
#passing attempts
pass.att <- season.2015 %>% dplyr::filter(pass.att > 0) %>% group_by(team,name,team2) %>% summarise(Passing.Attempts = sum(pass.att)) %>% ungroup() %>% arrange(desc(Passing.Attempts))
pass.att$rank <- c(1:nrow(pass.att))

(pass.att.plot <- hc_params %>%
  hc_add_series(name="Passing Attempts", data = subset(pass.att$Passing.Attempts, pass.att$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.att$name) %>%
  hc_title(text=paste("Passing Attempts - Top",top.n, sep=" "), align= alignment))

```

#### Completions
```{r, echo = F, fig.height=20, fig.width=10}
#completions
pass.comp <- season.2015 %>% dplyr::filter(pass.comp > 0) %>% group_by(team,name,team2) %>% summarise(Passing.Completion = sum(pass.comp)) %>% ungroup() %>% arrange(desc(Passing.Completion))
pass.comp$rank <- c(1:nrow(pass.comp))

(pass.comp.plot <- hc_params %>%
  hc_add_series(name="Completed Passes", data = subset(pass.comp$Passing.Completion, pass.comp$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.comp$name) %>%
  hc_title(text=paste("Completed Passes - Top",top.n, sep=" "), align= alignment))
```

#### Passing Yards
```{r, echo=F, fig.height=20, fig.width=10}
#passing yards
pass.yds <- season.2015 %>% dplyr::filter(passyds > 0) %>% group_by(team,name,team2) %>% summarise(Passing.Yards = sum(passyds)) %>% ungroup() %>% arrange(desc(Passing.Yards))
pass.yds$rank <- c(1:nrow(pass.yds))

(pass.yds.plot <- hc_params %>%
  hc_add_series(name="Passing Yards", data = subset(pass.yds$Passing.Yards, pass.yds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.yds$name) %>%
  hc_title(text=paste("Passing Yards - Top",top.n, sep=" "), align= alignment))
```

#### Passing TDs
```{r, echo=F, fig.height=20, fig.width=10}
#Passing Touchdowns
pass.tds <- season.2015 %>% dplyr::filter(pass.tds > 0) %>% group_by(team,name,team2) %>% summarise(Passing.tds = sum(pass.tds)) %>% ungroup() %>% arrange(desc(Passing.tds))
pass.tds$rank <- c(1:nrow(pass.tds))

(pass.tds.plot <- hc_params %>%
  hc_add_series(name="Passing Touchdowns", data = subset(pass.tds$Passing.tds, pass.tds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.tds$name) %>%
  hc_title(text=paste("Passing Touchdowns - Top",top.n, sep=" "), align= alignment))
```


#### Int's Thrown
```{r, echo=F, fig.height=20, fig.width=10}
#Interceptions thrown
pass.int <- season.2015 %>% dplyr::filter(pass.ints > 0) %>% group_by(team,name,team2) %>% summarise(Passing.int = sum(pass.ints)) %>% ungroup() %>% arrange(desc(Passing.int))
pass.int$rank <- c(1:nrow(pass.int))

(pass.int.plot <- hc_params%>%
  hc_add_series(name="Interceptions Thrown", data = subset(pass.int$Passing.int, pass.int$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.int$name) %>%
  hc_title(text=paste("Interceptions - Top",top.n, sep=" "), align= alignment))
```

#### Receptions
```{r, echo = F}
#receptions
recept <- season.2015 %>% dplyr::filter(recept > 0) %>% group_by(team,name,team2) %>% summarise(recept = sum(recept)) %>% ungroup() %>% arrange(desc(recept))
recept$rank <- c(1:nrow(recept))

(recept.plot <- hc_params %>%
  hc_add_series(name="Receptions", data = subset(recept$recept, recept$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = recept$name) %>%
  hc_title(text=paste("Receptions - Top",top.n, sep=" "), align= alignment))

```

#### Recieving Yards
```{r, echo = F}
#reception yards
rec.yds <- season.2015 %>% dplyr::filter(recyds > 0) %>% group_by(team,name,team2) %>% summarise(rec.yds = sum(recyds)) %>% ungroup() %>% arrange(desc(rec.yds))
rec.yds$rank <- c(1:nrow(rec.yds))

(rec.yds.plot <- hc_params %>%
  hc_add_series(name="Recieving Yards", data = subset(rec.yds$rec.yds, rec.yds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rec.yds$name) %>%
  hc_title(text=paste("Recieving Yards - Top",top.n, sep=" "), align= alignment))

```

#### Longest Reception
```{r, echo=F}
#longest reception
reclng <- season.2015 %>% dplyr::filter(reclng > 0) %>% group_by(team,name,team2) %>% summarise(reclng = sum(reclng)) %>% ungroup() %>% arrange(desc(reclng))
reclng$rank <- c(1:nrow(reclng))

(reclng.plot <- hc_params %>%
  hc_add_series(name="Longest Reception", data = subset(reclng$reclng, reclng$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = reclng$name) %>%
  hc_title(text=paste("Longest Reception - Top",top.n, sep=" "), align= alignment))

```

#### Recieving TDs
```{r, echo=F}
#reception tds
rec.tds <- season.2015 %>% dplyr::filter(rec.tds > 0) %>% group_by(team,name,team2) %>% summarise(rec.tds = sum(rec.tds)) %>% ungroup() %>% arrange(desc(rec.tds))
rec.tds$rank <- c(1:nrow(rec.tds))

(rec.tds.plot <- hc_params %>%
  hc_add_series(name="Recieving TDs", data = subset(rec.tds$rec.tds, rec.tds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rec.tds$name) %>%
  hc_title(text=paste("Recieving Touchdowns - Top",top.n, sep=" "), align= alignment))


```

#### Fumbles
```{r, echo=F}
#fumbles
fumbs <- season.2015 %>% dplyr::filter(totalfumbs > 0) %>% group_by(team,name,team2) %>% summarise(fumbs= sum(totalfumbs)) %>% ungroup() %>% arrange(desc(fumbs))
fumbs$rank <- c(1:nrow(fumbs))

(fumbs.plot <- hc_params %>%
  hc_add_series(name="Fumbles", data = subset(fumbs$fumbs, fumbs$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = fumbs$name) %>%
  hc_title(text=paste("Fumbles - Top",top.n, sep=" "), align= alignment))
```

#### Fumbles Lost
```{r, echo=F}
#fumbles lost
fumbs.lost <- season.2015 %>% dplyr::filter(fumbslost > 0) %>% group_by(team,name,team2) %>% summarise(fumbs.lost = sum(fumbslost)) %>% ungroup() %>% arrange(desc(fumbs.lost))
fumbs.lost$rank <- c(1:nrow(fumbs.lost))

(fumbs.lost.plot <- hc_params %>%
  hc_add_series(name="Lost Fumbles", data = subset(fumbs.lost$fumbs.lost, fumbs.lost$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = fumbs.lost$name) %>%
  hc_title(text=paste("Lost Fumbles - Top",top.n, sep=" "), align= alignment))

```


#### Rushing Attempts
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing Attempts
rush.att <- season.2015 %>% dplyr::filter(rush.att > 0) %>% group_by(team,name,team2) %>% summarise(rush.att = sum(rush.att)) %>% ungroup() %>% arrange(desc(rush.att))
rush.att$rank <- c(1:nrow(rush.att))

(rush.att.plot <- hc_params %>%
  hc_add_series(name="Rushing Attempts", data = subset(rush.att$rush.att, rush.att$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rush.att$name) %>%
  hc_title(text=paste("Rushing Attempts - Top",top.n, sep=" "), align= alignment))
```

#### Rushing Yards
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing Yards
rush.yds <- season.2015 %>% dplyr::filter(rushyds > 0) %>% group_by(team,name,team2) %>% summarise(rush.yds = sum(rushyds)) %>% ungroup() %>% arrange(desc(rush.yds))
rush.yds$rank <- c(1:nrow(rush.yds))

(rush.yds.plot <- hc_params %>%
  hc_add_series(name="Rushing Yards", data = subset(rush.yds$rush.yds, rush.yds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rush.yds$name) %>%
  hc_title(text=paste("Rushing Yards - Top",top.n, sep=" "), align= alignment))
```

#### Rushing Yds/Att
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing Yards / Att
rush.yds.att <- season.2015 %>% select(rushyds, rush.att, team, name, team2) %>% dplyr::filter(rush.att > (4*16)) %>% group_by(team,name,team2) %>% summarise(rush.yds.att = (rushyds/rush.att)) %>% ungroup() %>% arrange(desc(rush.yds.att))
rush.yds.att$rank <- c(1:nrow(rush.yds.att))
rush.yds.att$rush.yds.att <- round(rush.yds.att$rush.yds.att, 2)

(rush.yds.att.plot <- hc_params %>%
  hc_add_series(name="Rushing Yards/Attempt", data = subset(rush.yds.att$rush.yds.att, rush.yds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rush.yds.att$name) %>%
  hc_title(text=paste("Rushing Yards / Attempt - Top",top.n, sep=" "), align= alignment) %>%
  hc_subtitle(text="For players with at least 4 carriers per game, 2015 Season (Click & Drag to Zoom)", align=alignment))
```

#### Rushing TDs
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing TDs
rush.tds <- season.2015 %>% dplyr::filter(rushtds > 0) %>% group_by(team,name,team2) %>% summarise(rush.tds = sum(rushtds)) %>% ungroup() %>% arrange(desc(rush.tds))
rush.tds$rank <- c(1:nrow(rush.tds))

(rush.tds.att.plot <- hc_params %>%
  hc_add_series(name="Rushing Touchdowns", data = subset(rush.tds$rush.tds, rush.tds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rush.tds$name) %>%
  hc_title(text=paste("Rushing Touchdowns - Top",top.n, sep=" "), align= alignment))
```



### Defense {.tabset} 
#### Sacks
```{r, echo=F}
#sacks
sacks <- season.2015 %>% dplyr::filter(sacks > 0) %>% group_by(team,name,team2) %>% summarise(sacks = sum(sacks)) %>% ungroup() %>% arrange(desc(sacks))
sacks$rank <- c(1:nrow(sacks))

(sacks.plot <- hc_params %>%
  hc_add_series(name="Sacks", data = subset(sacks$sacks, sacks$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = sacks$name)  %>%
  hc_title(text=paste("Sacks - Top",top.n, sep=" "), align= alignment))
```

#### Tackles
```{r, echo = F}
#tackles
tackles <- season.2015 %>% dplyr::filter(tackles> 0) %>% group_by(team,name,team2) %>% summarise(tackles = sum(tackles)) %>% ungroup() %>% arrange(desc(tackles))
tackles$rank <- c(1:nrow(tackles))

(tackles.plot <- hc_params %>%
  hc_add_series(name="Tackles", data = subset(tackles$tackles, tackles$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = tackles$name)  %>%
  hc_title(text=paste("Taclkes - Top",top.n, sep=" "), align= alignment))
```

#### Assisted Tackles
```{r, echo=F}
#assisted tackles
asst.tackles <- season.2015 %>% dplyr::filter(asst.tackles> 0) %>% group_by(team,name,team2) %>% summarise(asst.tackles = sum(asst.tackles)) %>% ungroup() %>% arrange(desc(asst.tackles))
asst.tackles$rank <- c(1:nrow(asst.tackles))

(asst.tackles.plot <- hc_params %>%
  hc_add_series(name="Assisted Tackles", data = subset(asst.tackles$asst.tackles, asst.tackles$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = asst.tackles$name) %>%
  hc_title(text=paste("Assisted Tackles - Top",top.n, sep=" "), align= alignment))
```

#### Forced Fumbles
```{r, echo = F}
#Forced Fumbles
forced.fumbs <- season.2015 %>% dplyr::filter(forced.fumbs> 0) %>% group_by(team,name,team2) %>% summarise(forced.fumbs = sum(forced.fumbs)) %>% ungroup() %>% arrange(desc(forced.fumbs))
forced.fumbs$rank <- c(1:nrow(forced.fumbs))

(tackles.plot <- hc_params %>%
  hc_add_series(name="Forced Fumbles", data = subset(forced.fumbs$forced.fumbs, forced.fumbs$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = forced.fumbs$name) %>%
  hc_title(text=paste("Forced Fumbles - Top",top.n, sep=" "), align= alignment))
```

#### Interceptions
```{r, echo = F}
#Defensive Interceptions
defints <- season.2015 %>% dplyr::filter(defints > 0) %>% group_by(team,name,team2) %>% summarise(defints = sum(defints)) %>% ungroup() %>% arrange(desc(defints))
defints$rank <- c(1:nrow(defints))

(def.ints.plot <- hc_params %>%
  hc_add_series(name="Defensive Interceptions", data = subset(defints$defints, defints$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = defints$name) %>%
  hc_title(text=paste("Defensive Interceptions - Top",top.n, sep=" "), align= alignment))
```



### Special Teams {.tabset}
#### Field Goal Percentage
```{r, echo=F}
#field goal percentage
fg <- season.2015 %>% select(team, name, team2, fga, fgm) %>% dplyr::filter(fga > 5) %>% group_by(team,name,team2) %>% summarise(fg = (fgm/fga)) %>% ungroup() %>% arrange(desc(fg))
fg$rank <- c(1:nrow(fg))

(fg.plot <- hc_params %>%
  hc_add_series(name="Field Goal Percentage", data = subset(fg$fg, fg$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = fg$name)  %>%
  hc_title(text=paste("Field Goal Percentage - Top",top.n, sep=" "), align= alignment))
```


#### Field Goal points
```{r, echo=F}
#field goal points
fg.points <- season.2015 %>% dplyr::filter(totpts.fg > 0) %>% group_by(team,name,team2) %>% summarise(fg.points = sum(totpts.fg)) %>% ungroup() %>% arrange(desc(fg.points))
fg.points$rank <- c(1:nrow(fg.points))

(fg.points.plot <- hc_params %>%
  hc_add_series(name="Field Goal Points", data = subset(fg.points$fg.points, fg.points$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = fg.points$name) %>%
  hc_title(text=paste("Field Goal Points - Top",top.n, sep=" "), align= alignment))
```

#### Missed Extra Points
```{r, echo=F}
#extra points missed
xp.missed <- season.2015 %>% dplyr::filter(xpmissed > 0) %>% group_by(team,name,team2) %>% summarise(xp.missed = sum(xpmissed)) %>% ungroup() %>% arrange(desc(xp.missed))
xp.missed$rank <- c(1:nrow(xp.missed))

(xp.missed.plot <- hc_params %>%
  hc_add_series(name="Missed Extra Points", data = subset(xp.missed$xp.missed, xp.missed$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = xp.missed$name)  %>%
  hc_title(text=paste("Missed Extra Points - Top",top.n, sep=" "), align= alignment))
```










## Team Stats {.tabset}
### Offense {.tabset}
#### Passing Attempts
```{r, echo = F, fig.height = 20, fig.width = 10 }

#passing attempts
pass.att <- season.2015 %>% dplyr::filter(pass.att > 0) %>% group_by(team) %>% summarise(Passing.Attempts = sum(pass.att)) %>% ungroup() %>% arrange(desc(Passing.Attempts))
pass.att$rank <- c(1:nrow(pass.att))

(pass.att.plot <- hc_params %>%
  hc_add_series(name="Passing Attempts", data = subset(pass.att$Passing.Attempts, pass.att$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.att$team)  %>%
  hc_title(text=paste("Passing Attempts - Top",top.n, sep=" "), align= alignment))
```

#### Completions
```{r, echo = F, fig.height=20, fig.width=10}
#completions
pass.comp <- season.2015 %>% dplyr::filter(pass.comp > 0) %>% group_by(team) %>% summarise(Passing.Completion = sum(pass.comp)) %>% ungroup() %>% arrange(desc(Passing.Completion))
pass.comp$rank <- c(1:nrow(pass.comp))

(pass.comp.plot <- hc_params %>%
  hc_add_series(name="Completed Passes", data = subset(pass.att$Passing.Attempts, pass.att$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.att$team) %>%
  hc_title(text=paste("Completed Passes - Top",top.n, sep=" "), align= alignment))
```

#### Passing Yards
```{r, echo=F, fig.height=20, fig.width=10}
#passing yards
pass.yds <- season.2015 %>% dplyr::filter(passyds > 0) %>% group_by(team) %>% summarise(Passing.Yards = sum(passyds)) %>% ungroup() %>% arrange(desc(Passing.Yards))
pass.yds$rank <- c(1:nrow(pass.yds))

(pass.yds.plot <- hc_params %>%
  hc_add_series(name="Passing Yards", data = subset(pass.yds$Passing.Yards, pass.yds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.yds$team)  %>%
  hc_title(text=paste("Passing Yards - Top",top.n, sep=" "), align= alignment))
```

#### Passing TDs
```{r, echo=F, fig.height=20, fig.width=10}
#Passing Touchdowns
pass.tds <- season.2015 %>% dplyr::filter(pass.tds > 0) %>% group_by(team) %>% summarise(Passing.tds = sum(pass.tds)) %>% ungroup() %>% arrange(desc(Passing.tds))
pass.tds$rank <- c(1:nrow(pass.tds))

(pass.tds.plot <- hc_params %>%
  hc_add_series(name="Passing Touchdowns", data = subset(pass.tds$Passing.tds, pass.tds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.tds$team)  %>%
  hc_title(text=paste("Passing Touchdowns - Top",top.n, sep=" "), align= alignment))
```


#### Int's Thrown
```{r, echo=F, fig.height=20, fig.width=10}
#Interceptions thrown
pass.int <- season.2015 %>% dplyr::filter(pass.ints > 0) %>% group_by(team) %>% summarise(Passing.int = sum(pass.ints)) %>% ungroup() %>% arrange(desc(Passing.int))
pass.int$rank <- c(1:nrow(pass.int))

(pass.int.plot <- hc_params%>%
  hc_add_series(name="Interceptions Thrown", data = subset(pass.int$Passing.int, pass.int$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = pass.int$team) %>%
  hc_title(text=paste("Interceptions Thrown - Top",top.n, sep=" "), align= alignment))
```

#### Receptions
```{r, echo=F}
#receptions
recept <- season.2015 %>% dplyr::filter(recept > 0) %>% group_by(team) %>% summarise(recept = sum(recept)) %>% ungroup() %>% arrange(desc(recept))
recept$rank <- c(1:nrow(recept))

(recept.plot <- hc_params %>%
  hc_add_series(name="Receptions", data = subset(recept$recept, recept$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = recept$team)  %>%
  hc_title(text=paste("Receptions - Top",top.n, sep=" "), align= alignment))
```

#### Recieving Yards
```{r, echo = F}
#reception yards
rec.yds <- season.2015 %>% dplyr::filter(recyds > 0) %>% group_by(team) %>% summarise(rec.yds = sum(recyds)) %>% ungroup() %>% arrange(desc(rec.yds))
rec.yds$rank <- c(1:nrow(rec.yds))

(rec.yds.plot <- hc_params %>%
  hc_add_series(name="Recieving Yards", data = subset(rec.yds$rec.yds, rec.yds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rec.yds$team) %>%
  hc_title(text=paste("Recieving Yards - Top",top.n, sep=" "), align= alignment))
```

#### Recieving TDs
```{r, echo=F}
#reception tds
rec.tds <- season.2015 %>% dplyr::filter(rec.tds > 0) %>% group_by(team) %>% summarise(rec.tds = sum(rec.tds)) %>% ungroup() %>% arrange(desc(rec.tds))
rec.tds$rank <- c(1:nrow(rec.tds))

(rec.tds.plot <- hc_params %>%
  hc_add_series(name="Recieving TDs", data = subset(rec.tds$rec.tds, rec.tds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rec.tds$team)  %>%
  hc_title(text=paste("Recieving Touchdowns - Top",top.n, sep=" "), align= alignment))
```

#### Fumbles
```{r, echo=F}
#fumbles
fumbs <- season.2015 %>% dplyr::filter(totalfumbs > 0) %>% group_by(team) %>% summarise(fumbs= sum(totalfumbs)) %>% ungroup() %>% arrange(desc(fumbs))
fumbs$rank <- c(1:nrow(fumbs))

(fumbs.plot <- hc_params %>%
  hc_add_series(name="Fumbles", data = subset(fumbs$fumbs, fumbs$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = fumbs$team)  %>%
  hc_title(text=paste("Fumbles - Top",top.n, sep=" "), align= alignment))
```

#### Fumbles Lost
```{r, echo=F}
#fumbles lost
fumbs.lost <- season.2015 %>% dplyr::filter(fumbslost > 0) %>% group_by(team) %>% summarise(fumbs.lost = sum(fumbslost)) %>% ungroup() %>% arrange(desc(fumbs.lost))
fumbs.lost$rank <- c(1:nrow(fumbs.lost))

(fumbs.lost.plot <- hc_params %>%
  hc_add_series(name="Lost Fumbles", data = subset(fumbs.lost$fumbs.lost, fumbs.lost$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = fumbs.lost$team)  %>%
  hc_title(text=paste("Lost Fumbles - Top",top.n, sep=" "), align= alignment))
```


#### Rushing Attempts
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing Attempts
rush.att <- season.2015 %>% dplyr::filter(rush.att > 0) %>% group_by(team) %>% summarise(rush.att = sum(rush.att)) %>% ungroup() %>% arrange(desc(rush.att))
rush.att$rank <- c(1:nrow(rush.att))

(rush.att.plot <- hc_params %>%
  hc_add_series(name="Rushing Attempts", data = subset(rush.att$rush.att, rush.att$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rush.att$team) %>%
  hc_title(text=paste("Rushing Attempts - Top",top.n, sep=" "), align= alignment))
```

#### Rushing Yards
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing Yards
rush.yds <- season.2015 %>% dplyr::filter(rushyds > 0) %>% group_by(team) %>% summarise(rush.yds = sum(rushyds)) %>% ungroup() %>% arrange(desc(rush.yds))
rush.yds$rank <- c(1:nrow(rush.yds))

(rush.yds.plot <- hc_params %>%
  hc_add_series(name="Rushing Yards", data = subset(rush.yds$rush.yds, rush.yds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rush.yds$team)  %>%
  hc_title(text=paste("Rushing Yards - Top",top.n, sep=" "), align= alignment))
```


#### Rushing TDs
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing TDs
rush.tds <- season.2015 %>% dplyr::filter(rushtds > 0) %>% group_by(team) %>% summarise(rush.tds = sum(rushtds)) %>% ungroup() %>% arrange(desc(rush.tds))
rush.tds$rank <- c(1:nrow(rush.tds))

(rush.tds.att.plot <- hc_params %>%
  hc_add_series(name="Rushing Touchdowns", data = subset(rush.tds$rush.tds, rush.tds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = rush.tds$team)  %>%
  hc_title(text=paste("Rushing Touchdowns - Top",top.n, sep=" "), align= alignment))
```

### Defense {.tabset}
#### Sacks
```{r, echo=F}
# sacks
sacks <- season.2015 %>% dplyr::filter(sacks > 0) %>% group_by(team) %>% summarise(sacks = sum(sacks)) %>% ungroup() %>% arrange(desc(sacks))
sacks$rank <- c(1:nrow(sacks))

(sacks.plot <- hc_params %>%
  hc_add_series(name="Sacks", data = subset(sacks$sacks, sacks$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = sacks$team)  %>%
  hc_title(text=paste("Sacks - Top",top.n, sep=" "), align= alignment))
```

#### Tackles
```{r, echo = F}
#tackles
tackles <- season.2015 %>% dplyr::filter(tackles> 0) %>% group_by(team) %>% summarise(tackles = sum(tackles)) %>% ungroup() %>% arrange(desc(tackles))
tackles$rank <- c(1:nrow(tackles))

(tackles.plot <- hc_params %>%
  hc_add_series(name="Tackles", data = subset(tackles$tackles, tackles$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = tackles$team)  %>%
  hc_title(text=paste("Tackles - Top",top.n, sep=" "), align= alignment))
```

#### Assisted Tackles
```{r, echo=F}
#assisted tackles
asst.tackles <- season.2015 %>% dplyr::filter(asst.tackles> 0) %>% group_by(team) %>% summarise(asst.tackles = sum(asst.tackles)) %>% ungroup() %>% arrange(desc(asst.tackles))
asst.tackles$rank <- c(1:nrow(asst.tackles))

(asst.tackles.plot <- hc_params %>%
  hc_add_series(name="Assisted Tackles", data = subset(asst.tackles$asst.tackles, asst.tackles$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = asst.tackles$team)  %>%
  hc_title(text=paste("Assisted Tackles - Top",top.n, sep=" "), align= alignment))
```

#### Forced Fumbles
```{r, echo = F}
#Forced Fumbles
forced.fumbs <- season.2015 %>% dplyr::filter(forced.fumbs> 0) %>% group_by(team) %>% summarise(forced.fumbs = sum(forced.fumbs)) %>% ungroup() %>% arrange(desc(forced.fumbs))
forced.fumbs$rank <- c(1:nrow(forced.fumbs))

(tackles.plot <- hc_params %>%
  hc_add_series(name="Forced Fumbles", data = subset(forced.fumbs$forced.fumbs, forced.fumbs$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = forced.fumbs$team) %>%
  hc_title(text=paste("Forced Fumbles - Top",top.n, sep=" "), align= alignment))
```

#### Interceptions
```{r, echo = F}
#Defensive Interceptions
defints <- season.2015 %>% dplyr::filter(defints > 0) %>% group_by(team) %>% summarise(defints = sum(defints)) %>% ungroup() %>% arrange(desc(defints))
defints$rank <- c(1:nrow(defints))

(def.ints.plot <- hc_params %>%
  hc_add_series(name="Defensive Interceptions", data = subset(defints$defints, defints$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = defints$team)  %>%
  hc_title(text=paste("Defensive Interceptions- Top",top.n, sep=" "), align= alignment))
```

### Special Teams {.tabset}
#### Field Goal points
```{r, echo=F}
#field goal points
fg.points <- season.2015 %>% dplyr::filter(totpts.fg > 0) %>% group_by(team) %>% summarise(fg.points = sum(totpts.fg)) %>% ungroup() %>% arrange(desc(fg.points))
fg.points$rank <- c(1:nrow(fg.points))

(fg.points.plot <- hc_params %>%
  hc_add_series(name="Field Goal Points", data = subset(fg.points$fg.points, fg.points$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = fg.points$team)  %>%
  hc_title(text=paste("Field Goal Points - Top",top.n, sep=" "), align= alignment))
```

#### Missed Extra Points
```{r, echo=F}
#extra points missed
xp.missed <- season.2015 %>% dplyr::filter(xpmissed > 0) %>% group_by(team) %>% summarise(xp.missed = sum(xpmissed)) %>% ungroup() %>% arrange(desc(xp.missed))
xp.missed$rank <- c(1:nrow(xp.missed))

(xp.missed.plot <- hc_params %>%
  hc_add_series(name="Missed Extra Points", data = subset(xp.missed$xp.missed, xp.missed$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = xp.missed$team)  %>%
  hc_title(text=paste("Missed Extra Points - Top",top.n, sep=" "), align= alignment))
```





# Eagles {.tabset}
## Offense {.tabset}
### QBs {.tabset}
#### Bradford
```{r, echo=F}
qb <- phl %>% select(name, pass.att, passyds, pass.tds, pass.ints, pass.ints, fumbslost, totalfumbs, rushyds) %>% dplyr::filter(name == "S.Bradford" |  name == "M.Sanchez") %>% arrange(desc(name))
qb$yds.att <- qb$passyds/qb$pass.att
qb <- qb %>% select(name, pass.att, passyds, pass.tds, yds.att, pass.ints, rushyds, totalfumbs, fumbslost)
names(qb)[1] <- "Name"
names(qb)[2] <- "Passing Attempts"
names(qb)[3] <- "Passing Yards"
names(qb)[4] <- "Touchdown Passes"
names(qb)[5] <- "Yards Per Pass"
names(qb)[6] <- "Interceptions"
names(qb)[7] <- "Rushing Yards"
names(qb)[8] <- "Fumbless"
names(qb)[9] <- "Lost Fumbles"
qb.melt <- melt(qb, id.vars = "Name")

(bradford.plot <- hc_params %>%
  hc_add_series(name="Bradford", data = subset(qb.melt$value, qb.melt$Name == "S.Bradford" & qb.melt$variable != "Passing Yards" & qb.melt$variable != "Passing Attempts"), type = plot.type) %>%
  hc_xAxis(categories = subset(qb.melt$variable, qb.melt$Name == "S.Bradford" & qb.melt$variable != "Passing Yards"& qb.melt$variable != "Passing Attempts")) %>%
  hc_title(text = paste("Sam Bradford:",qb.melt[4,3], "Passing Yards,", qb.melt[2,3], "Passing Attempts", by =" "), align = alignment))

knitr::kable(qb, col.names = c("", "Passing Attempts", "Passing Yds", "TD Passes", "Yards/Pass", "Int", "Rushing Yds", "Fumbles", "Lost Fumbles"))
```

#### Sanchez
```{r, echo=F}
(sanchez.plot <- hc_params %>%
  hc_add_series(name="Sanchez", data = subset(qb.melt$value, qb.melt$Name == "M.Sanchez"& qb.melt$variable != "Passing Yards"& qb.melt$variable != "Passing Attempts"), type = plot.type)  %>%
  hc_xAxis(categories = subset(qb.melt$variable, qb.melt$Name == "S.Bradford" & qb.melt$variable != "Passing Yards"& qb.melt$variable != "Passing Attempts")) %>%
  hc_title(text = paste("Mark Sanchez:",qb.melt[3,3], "Passing Yards,", qb.melt[1,3], "Passing Attempts", by =" "), align = alignment))
  
knitr::kable(qb, col.names = c("", "Passing Attempts", "Passing Yds", "TD Passes", "Yards/Pass", "Int", "Rushing Yds", "Fumbles", "Lost Fumbles"))


```



### Receptions
```{r, echo = F, fig.height=20, fig.width=10}
#receptions
recept.phl <- phl %>% dplyr::filter(recept > 0) %>% group_by(name) %>% summarise(recept = sum(recept)) %>% ungroup() %>% arrange(desc(recept))
recept.phl$rank <- c(1:nrow(recept.phl))

(recept.phl.plot <- hc_params %>%
  hc_add_series(name="Receptions", data = subset(recept.phl$recept, recept.phl$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = recept.phl$name) %>%
  hc_title(text=paste("Receptions:", sum(recept.phl$recept), by = " "), align= alignment))

```

### Recieving Yards
```{r, echo=F, fig.height=20, fig.width=10}
#reception yards
phl.rec.yds <- phl %>% dplyr::filter(recyds > 0) %>% group_by(name) %>% summarise(rec.yds = sum(recyds)) %>% ungroup() %>% arrange(desc(rec.yds))
phl.rec.yds$rank <- c(1:nrow(phl.rec.yds))

(phl.rec.yds.plot <- hc_params %>%
  hc_add_series(name="Recieving Yards", data = subset(phl.rec.yds$rec.yds, phl.rec.yds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.rec.yds$name) %>%
  hc_title(text=paste("Recieving Yards:", sum(phl.rec.yds$rec.yds), by = " "), align= alignment))
```

### Yds per Catch
```{r, echo=F, fig.height=20, fig.width=10}
#receiving yds / attempt
phl.rec.yds.att <- left_join(recept.phl, phl.rec.yds, by="name")
phl.rec.yds.att$rank.x <- NULL
phl.rec.yds.att$rank.y <- NULL
phl.rec.yds.att$yds.att <- phl.rec.yds.att$rec.yds/phl.rec.yds.att$recept
phl.rec.yds.att <- phl.rec.yds.att %>% arrange(desc(yds.att))
phl.rec.yds.att$rank <- c(1:nrow(phl.rec.yds.att))
phl.rec.yds.att$yds.att <- round(phl.rec.yds.att$yds.att, 2)

(phl.rec.yds.att.plot <- hc_params %>%
  hc_add_series(name="Yards per Catch", data = subset(phl.rec.yds.att$yds.att, phl.rec.yds.att$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.rec.yds.att$name) %>%
  hc_title(text=paste("Avg. Yards Per Catch:", format(mean(phl.rec.yds.att$yds.att), digits=4), by = " "), align= alignment))
```

### Longest Reception
```{r, echo=F, fig.height=20, fig.width=10}
#longest reception
phl.reclng <- phl %>% dplyr::filter(reclng > 0) %>% group_by(name) %>% summarise(reclng = sum(reclng)) %>% ungroup() %>% arrange(desc(reclng))
phl.reclng$rank <- c(1:nrow(phl.reclng))

(reclng.plot <- hc_params %>%
  hc_add_series(name="Longest Reception", data = subset(phl.reclng$reclng, phl.reclng$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.reclng$name) %>%
  hc_title(text=paste("Longest Reception:", max(phl.reclng$reclng), "Yards", by = " "), align= alignment))
```

### Recieving TDs
```{r, echo=F, fig.height=20, fig.width=10}
#reception tds
phl.rec.tds <- phl %>% dplyr::filter(rec.tds > 0) %>% group_by(name) %>% summarise(rec.tds = sum(rec.tds)) %>% ungroup() %>% arrange(desc(rec.tds))
phl.rec.tds$rank <- c(1:nrow(phl.rec.tds))

(rec.tds.plot <- hc_params %>%
  hc_add_series(name="Recieving Touchdowns", data = subset(phl.rec.tds$rec.tds, phl.rec.tds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.rec.tds$name) %>%
  hc_title(text=paste("Recieving Touchdowns:", sum(phl.rec.tds$rec.tds), by = " "),align= alignment))
```

### Fumbles
```{r, echo=F, fig.height=20, fig.width=10}
#fumbles
phl.fumbs <- phl %>% dplyr::filter(totalfumbs > 0) %>% group_by(name) %>% summarise(fumbs= sum(totalfumbs)) %>% ungroup() %>% arrange(desc(fumbs))
phl.fumbs$rank <- c(1:nrow(phl.fumbs))

(fumbs.plot <- hc_params %>%
  hc_add_series(name="Fumbles", data = subset(phl.fumbs$fumbs, phl.fumbs$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.fumbs$name) %>%
  hc_title(text=paste("Fumbles:", sum(phl.fumbs$fumbs), by = " "), align= alignment))
```

### Lost Fumbles
```{r, echo=F, fig.height=20, fig.width=10}
#fumbles lost
phl.fumbs.lost <- phl %>% dplyr::filter(fumbslost > 0) %>% group_by(name) %>% summarise(fumbs.lost = sum(fumbslost)) %>% ungroup() %>% arrange(desc(fumbs.lost))
phl.fumbs.lost$rank <- c(1:nrow(phl.fumbs.lost))

(fumbs.lost.plot <- hc_params %>%
  hc_add_series(name="Lost Fumbles", data = subset(phl.fumbs.lost$fumbs.lost, phl.fumbs.lost$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.fumbs.lost$name) %>%
  hc_title(text=paste("Lost Fumbles:", sum(phl.fumbs.lost$fumbs.lost), by = " "), align= alignment))
```

### Rushing Attempts
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing Attempts
phl.rush.att <- phl %>% dplyr::filter(rush.att > 0) %>% group_by(name) %>% summarise(rush.att = sum(rush.att)) %>% ungroup() %>% arrange(desc(rush.att))
phl.rush.att$rank <- c(1:nrow(phl.rush.att))

(rush.att.plot <- hc_params %>%
  hc_add_series(name="Rushing Attempts", data = subset(phl.rush.att$rush.att, phl.rush.att$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.rush.att$name) %>%
  hc_title(text=paste("Rushing Attempts:", sum(phl.rush.att$rush.att), by = " "),align= alignment))
```

### Rushing Yards
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing Yards
phl.rush.yds <- phl %>% dplyr::filter(rushyds > 0) %>% group_by(name) %>% summarise(rush.yds = sum(rushyds)) %>% ungroup() %>% arrange(desc(rush.yds))
phl.rush.yds$rank <- c(1:nrow(phl.rush.yds))

(rush.yds.plot <- hc_params %>%
  hc_add_series(name="Rushing Yards", data = subset(phl.rush.yds$rush.yds, phl.rush.yds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.rush.yds$name) %>%
  hc_title(text=paste("Rushing Yards:", sum(phl.rush.yds$rush.yds), by = " "), align= alignment))
```

### Rushing Yds Per Carry
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing Yards / Att
phl.rush.yds.att <- left_join(phl.rush.att, phl.rush.yds, by="name")
phl.rush.yds.att$rank.x <- NULL
phl.rush.yds.att$rank.y <- NULL
phl.rush.yds.att$yds.att <- phl.rush.yds.att$rush.yds/phl.rush.att$rush.att
phl.rush.yds.att <- phl.rush.yds.att %>% arrange(desc(yds.att))
phl.rush.yds.att$rank <- c(1:nrow(phl.rush.yds.att))
phl.rush.yds.att$yds.att <- round(phl.rush.yds.att$yds.att, 2)

(phl.rush.yds.att.plot <- hc_params %>%
  hc_add_series(name="Yards per Carry", data = subset(phl.rush.yds.att$yds.att, phl.rush.yds.att$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.rush.yds.att$name) %>%
  hc_title(text=paste("Avg Yards Per Carry:", format(mean(phl.rush.yds.att$yds.att),digits=3), by = " "), align= alignment))
```

### Rushing TDs
```{r, echo=F, fig.height=20, fig.width=10}
#Rushing TDs
phl.rush.tds <- phl %>% dplyr::filter(rushtds > 0) %>% group_by(name) %>% summarise(rush.tds = sum(rushtds)) %>% ungroup() %>% arrange(desc(rush.tds))
phl.rush.tds$rank <- c(1:nrow(phl.rush.tds))

(rush.tds.att.plot <- hc_params %>%
  hc_add_series(name="Rushing Touchdowns", data = subset(phl.rush.tds$rush.tds, phl.rush.tds$rank <=top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.rush.tds$name) %>%
  hc_title(text=paste("Rushing Touchdowns:", sum(phl.rush.tds$rush.tds), by = " "),align= alignment))
```

## Defense {.tabset}
### Sacks
```{r, echo=F, fig.height=20, fig.width=10}
#sacks
phl.sacks <- phl %>% dplyr::filter(sacks > 0) %>% group_by(name) %>% summarise(sacks = sum(sacks)) %>% ungroup() %>% arrange(desc(sacks))
phl.sacks$rank <- c(1:nrow(phl.sacks))

(sacks.plot <- hc_params %>%
  hc_add_series(name="Sacks", data = subset(phl.sacks$sacks, phl.sacks$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.sacks$name)  %>%
  hc_title(text=paste("Sacks:", sum(phl.sacks$sacks), by = " "), align= alignment))
```

### Tackles
```{r, echo=F, fig.height=20, fig.width=10}
#tackles
phl.tackles <- phl %>% dplyr::filter(tackles> 0) %>% group_by(name) %>% summarise(tackles = sum(tackles)) %>% ungroup() %>% arrange(desc(tackles))
phl.tackles$rank <- c(1:nrow(phl.tackles))

(tackles.plot <- hc_params %>%
  hc_add_series(name="Tackles", data = subset(phl.tackles$tackles, phl.tackles$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.tackles$name)  %>%
  hc_title(text=paste("Tackles:", sum(phl.tackles$tackles), by = " "), align= alignment))
```

### Assisted Tackles
```{r, echo=F, fig.height=20, fig.width=10}
#assisted tackles
phl.asst.tackles <- phl %>% dplyr::filter(asst.tackles> 0) %>% group_by(name) %>% summarise(asst.tackles = sum(asst.tackles)) %>% ungroup() %>% arrange(desc(asst.tackles))
phl.asst.tackles$rank <- c(1:nrow(phl.asst.tackles))

(asst.tackles.plot <- hc_params %>%
  hc_add_series(name="Assisted Tackles", data = subset(phl.asst.tackles$asst.tackles, phl.asst.tackles$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.asst.tackles$name) %>%
  hc_title(text=paste("Assisted Tackles:", sum(phl.asst.tackles$asst.tackles), by = " "), align= alignment))
```

### Forced Fubmles
```{r, echo=F, fig.height=20, fig.width=10}
#Forced Fumbles
phl.forced.fumbs <- phl %>% dplyr::filter(forced.fumbs> 0) %>% group_by(name) %>% summarise(forced.fumbs = sum(forced.fumbs)) %>% ungroup() %>% arrange(desc(forced.fumbs))
phl.forced.fumbs$rank <- c(1:nrow(phl.forced.fumbs))

(tackles.plot <- hc_params %>%
  hc_add_series(name="Forced Fumbles", data = subset(phl.forced.fumbs$forced.fumbs, phl.forced.fumbs$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.forced.fumbs$name) %>%
  hc_title(text=paste("Forced Fumbles:", sum(phl.forced.fumbs$forced.fumbs), by = " "), align= alignment))
```

### Defensive Ints
```{r, echo=F, fig.height=20, fig.width=10}
#Defensive Interceptions
phl.defints <- phl %>% dplyr::filter(defints > 0) %>% group_by(name) %>% summarise(defints = sum(defints)) %>% ungroup() %>% arrange(desc(defints))
phl.defints$rank <- c(1:nrow(phl.defints))

(def.ints.plot <- hc_params %>%
  hc_add_series(name="Defensive Interceptions", data = subset(phl.defints$defints, phl.defints$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.defints$name) %>%
  hc_title(text=paste("Defensive Interceptions:", sum(phl.defints$defints), by = " "), align= alignment))
```

## Special Teams {.tabset}
### Field Goal %
```{r, echo=F, fig.height=20, fig.width=10}
# Field Goal %
phl.fg <- phl %>% dplyr::filter(fga > 0) %>% select(name, fga, fgm) %>% group_by(name) %>% summarise(fg = (fgm/fga)) %>% ungroup() %>% arrange(desc(fg))
phl.fg$rank <- c(1:nrow(phl.fg))

(phl.fg.plot <- hc_params %>%
  hc_add_series(name="Field Goal Percentage", data = subset(phl.fg$fg, phl.fg$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.fg$name)  %>%
  hc_title(text=paste("Avg Field Goal Percentage:", format(mean(phl.fg$fg),digits=3), by = " "), align= alignment))
```

### Field Goal Pts
```{r, echo=F, fig.height=20, fig.width=10}
#field goal points
phl.fg.points <- phl %>% dplyr::filter(totpts.fg > 0) %>% group_by(name) %>% summarise(fg.points = sum(totpts.fg)) %>% ungroup() %>% arrange(desc(fg.points))
phl.fg.points$rank <- c(1:nrow(phl.fg.points))

(fg.points.plot <- hc_params %>%
  hc_add_series(name="Field Goal Points", data = subset(phl.fg.points$fg.points, phl.fg.points$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.fg.points$name) %>%
  hc_title(text=paste("Field Goal Points:", sum(phl.fg.points$fg.points), by = " "), align= alignment))
```

### Missed Extra Points
```{r, echo=F, fig.height=20, fig.width=10}
#extra points missed
phl.xp.missed <- phl %>% dplyr::filter(xpmissed > 0) %>% group_by(name) %>% summarise(xp.missed = sum(xpmissed)) %>% ungroup() %>% arrange(desc(xp.missed))
phl.xp.missed$rank <- c(1:nrow(phl.xp.missed))

(phl.xp.missed.plot <- hc_params %>%
  hc_add_series(name="Missed Extra Points", data = subset(phl.xp.missed$xp.missed, phl.xp.missed$rank <= top.n), type = plot.type)  %>%
  hc_xAxis(categories = phl.xp.missed$name)  %>%
  hc_title(text=paste("Missed Extra Points:", sum(phl.xp.missed$xp.missed), by = " "), align= alignment))
```


## Time Series Stuff {.tabset}
### Avg. Completion Rate Since 2009
```{r, echo = F}
#historical avg completion rate
hist.pass.comp.rate <- eagles.hist %>% select(date, name, pass.att, pass.comp) %>% dplyr::filter(pass.att > 5) %>% group_by(date, name) %>% summarise(total  = (pass.comp/pass.att))
hist.pass.comp.rate$date <- ymd(hist.pass.comp.rate$date)

bradford.ts <- xts(subset(hist.pass.comp.rate$total, hist.pass.comp.rate$name == "S.Bradford"), order.by = subset(hist.pass.comp.rate$date, hist.pass.comp.rate$name == "S.Bradford"), frequency = 52)
vick.ts <- xts(subset(hist.pass.comp.rate$total, hist.pass.comp.rate$name == "M.Vick"), order.by = subset(hist.pass.comp.rate$date, hist.pass.comp.rate$name == "M.Vick"), frequency = 52)
foles.ts <- xts(subset(hist.pass.comp.rate$total, hist.pass.comp.rate$name == "N.Foles"), order.by = subset(hist.pass.comp.rate$date, hist.pass.comp.rate$name == "N.Foles"), frequency = 52)
sanchez.ts <- xts(subset(hist.pass.comp.rate$total, hist.pass.comp.rate$name == "M.Sanchez"), order.by = subset(hist.pass.comp.rate$date, hist.pass.comp.rate$name == "M.Sanchez"), frequency = 52)
barkley.ts <- xts(subset(hist.pass.comp.rate$total, hist.pass.comp.rate$name == "M.Barkley"), order.by = subset(hist.pass.comp.rate$date, hist.pass.comp.rate$name == "M.Barkley"), frequency = 52)
mcnabb.ts <- xts(subset(hist.pass.comp.rate$total, hist.pass.comp.rate$name == "D.McNabb"), order.by = subset(hist.pass.comp.rate$date, hist.pass.comp.rate$name == "D.McNabb"), frequency = 52)
kolb.ts <- xts(subset(hist.pass.comp.rate$total, hist.pass.comp.rate$name == "K.Kolb"), order.by = subset(hist.pass.comp.rate$date, hist.pass.comp.rate$name == "K.Kolb"), frequency = 52)
young.ts <- xts(subset(hist.pass.comp.rate$total, hist.pass.comp.rate$name == "V.Young"), order.by = subset(hist.pass.comp.rate$date, hist.pass.comp.rate$name == "V.Young"), frequency = 52)
kafka.ts <- xts(subset(hist.pass.comp.rate$total, hist.pass.comp.rate$name == "M.Kafka"), order.by = subset(hist.pass.comp.rate$date, hist.pass.comp.rate$name == "M.Kafka"), frequency = 52)

(hist.comp.rate.plot <- hc_params %>%
  highchart(type = "chart") %>% 
  hc_add_series_xts(mcnabb.ts, id = "McNabb", name = "McNabb") %>%
  hc_add_series_xts(kolb.ts, id = "Kolb", name = "Kolb") %>%
  hc_add_series_xts(vick.ts, id = "Vick", name= "Vick") %>%
  hc_add_series_xts(kafka.ts, id = "Kafka", name = "Kafka") %>%
  hc_add_series_xts(young.ts, id = "Young", name = "Young") %>%
  hc_add_series_xts(foles.ts, id = "Foles", name = "Foles") %>%
  hc_add_series_xts(barkley.ts, id = "Barkley", name = "Barkley") %>% 
  hc_add_series_xts(sanchez.ts, id = "Sanchez", name = "Sanchez") %>%
  hc_add_series_xts(bradford.ts, id = "Bradford", name = "Bradford") %>%
  hc_title(text=paste("Historical Avg. Completion Rate:", format(mean(hist.pass.comp.rate$total),digits=2), by=" "), align="left") %>%
  hc_subtitle(text="2009-2015", align="left") %>%
  hc_legend(enabled = T)%>%
  hc_rangeSelector(inputEnabled = F) %>% 
  hc_scrollbar(enabled = FALSE))

```

### Running vs Passing Since 2009
```{r, echo=F}

#rushing vs passing
rush.pass <- eagles.hist %>% select(date, rush.att, pass.att) %>% group_by(date) %>% summarise_each(funs(sum))
rush.pass$date <- ymd(rush.pass$date)

rush.ts <- xts(rush.pass$rush.att, order.by = rush.pass$date, frequency = 52)
pass.ts <- xts(rush.pass$pass.att, order.by = rush.pass$date, frequency = 52)

(hist.comp.rate.plot <- hc_params %>%
  highchart(type = "chart") %>% 
  hc_add_series_xts(rush.ts, id = "Rush", name = "Rushing Plays") %>%
  hc_add_series_xts(pass.ts, id = "Pass", name = "Passing Plays") %>%
  hc_title(text="Rushing vs Passing Plays", align="left") %>%
  hc_subtitle(text="2009-2015", align="left") %>%
  hc_legend(enabled = T)%>%
  hc_rangeSelector(inputEnabled = F) %>% 
  hc_scrollbar(enabled = FALSE))
```
